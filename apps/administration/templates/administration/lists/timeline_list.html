{% extends 'administration/base_admin.html' %}
{% load static %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'administration/css/admin_lists.css' %}">
<link rel="stylesheet" href="{% static 'administration/css/lists/timeline_list.css' %}?v=3">
{% endblock %}

{% block content %}
<div class="list-container">
    <div class="list-header">
        <h2 class="admin-title">Timeline Events</h2>
        <p class="admin-subtitle">Schedule and manage election milestones</p>
        <a href="{% url 'administration:timeline_create' %}" class="btn-primary">
            <i class="fas fa-plus"></i> Add Timeline Event
        </a>
    </div>

    <!-- Filter Section -->
    <div class="filter-section">
        <form method="get" class="filter-form">
            <div class="filter-group">
                <label for="election">Filter by Election:</label>
                <select name="election" id="election" class="form-control" onchange="this.form.submit()">
                    <option value="">All Elections</option>
                    {% for election in elections %}
                    <option value="{{ election.id }}" {% if selected_election == election.id %}selected{% endif %}>
                        {{ election.name }}
                    </option>
                    {% endfor %}
                </select>
            </div>
        </form>
    </div>

    <!-- Timeline Events Table -->
    <div class="table-responsive">
        <table class="data-table">
            <thead>
                <tr>
                    <th>Election</th>
                    <th>Title</th>
                    <th>Start Time</th>
                    <th>End Time</th>
                    <th>Order</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody>
                {% for event in events %}
                <tr>
                    <td>{{ event.election.name }}</td>
                    <td>{{ event.title }}</td>
                    <td>{{ event.start_time|date:"M d, Y H:i" }}</td>
                    <td>{{ event.end_time|date:"M d, Y H:i" }}</td>
                    <td><span class="badge badge-order">{{ event.order }}</span></td>
                    <td class="actions">
                        <a href="{% url 'administration:timeline_edit' event.pk %}" class="btn-edit" title="Edit">
                            <i class="fas fa-edit"></i>
                        </a>
                        <form method="post" action="{% url 'administration:timeline_delete' event.pk %}" style="display: inline;">
                            {% csrf_token %}
                            <button type="submit" class="btn-delete" title="Delete" onclick="return confirm('Are you sure you want to delete this timeline event?')">
                                <i class="fas fa-trash"></i>
                            </button>
                        </form>
                    </td>
                </tr>
                {% empty %}
                <tr id="emptyState">
                        <td colspan="5" class="empty-state-container">
                            <div class="empty-state-content">
                                <div>
                                    <h3 class="empty-state-title">No timeline events found</h3>
                                    <p class="empty-state-description">Create timeline events for candidates to run for.</p>
                                </div>
                            </div>
                        </td>
                    </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>
{% endblock %}
